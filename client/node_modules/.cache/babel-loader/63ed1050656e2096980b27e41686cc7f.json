{"ast":null,"code":"import { GET_ERRORS, SET_CURRENT_USER, ALERT_REGISTRATION, HIDE_REGMODAL } from './types';\nimport setAuthToken from '../../utils/setAuthToken';\nimport jwt_decode from 'jwt-decode';\nimport axios from 'axios'; //Register\n\nexport var registerUser = function registerUser(userData, profileData, history) {\n  return function (dispatch) {\n    axios.post('api/users/register', userData).then(function (res) {\n      //make dummy userProfile db in registration\n      axios.post('/', profileData).then(function (res2) {\n        history.push('/login');\n        dispatch({\n          type: ALERT_REGISTRATION,\n          payload: res.data.name\n        });\n      }).catch(function (err2) {\n        return dispatch({\n          type: GET_ERRORS,\n          payload: err2.response.data\n        });\n      }); //----------------------------\n    }).catch(function (err) {\n      return dispatch({\n        type: GET_ERRORS,\n        payload: err.response.data\n      });\n    });\n  };\n}; //Hide registration modal\n\nexport var hideRegModal = function hideRegModal() {\n  return function (dispatch) {\n    dispatch({\n      type: HIDE_REGMODAL,\n      payload: null\n    });\n  };\n}; //Login\n\nexport var loginUser = function loginUser(userData) {\n  return function (dispatch) {\n    axios.post('api/users/login', userData).then(function (res) {\n      var token = res.data.token; //Save token to local storage\n\n      localStorage.setItem('jwtToken', token); //Set Auth header\n\n      setAuthToken(token); //Decode token to get current user data\n\n      var decoded = jwt_decode(token);\n      dispatch(setCurrentUser(decoded));\n    }).catch(function (err) {\n      return dispatch({\n        type: GET_ERRORS,\n        payload: err.response.data\n      });\n    });\n  };\n}; //set current user function\n\nexport var setCurrentUser = function setCurrentUser(decoded) {\n  return {\n    type: SET_CURRENT_USER,\n    payload: decoded\n  };\n}; //Log User Out\n\nexport var logUserOut = function logUserOut() {\n  return function (dispatch) {\n    //Delete token\n    localStorage.removeItem('jwtToken'); //Remove auth header\n\n    setAuthToken(false); //Set current user to {}\n\n    dispatch(setCurrentUser({})); //dispatch to update the store\n    //\n  };\n};","map":{"version":3,"sources":["D:\\Docs\\mernstack\\Rating App\\client\\src\\redux\\actions\\authActions.js"],"names":["GET_ERRORS","SET_CURRENT_USER","ALERT_REGISTRATION","HIDE_REGMODAL","setAuthToken","jwt_decode","axios","registerUser","userData","profileData","history","dispatch","post","then","res","res2","push","type","payload","data","name","catch","err2","response","err","hideRegModal","loginUser","token","localStorage","setItem","decoded","setCurrentUser","logUserOut","removeItem"],"mappings":"AAAA,SACGA,UADH,EAEGC,gBAFH,EAGGC,kBAHH,EAIGC,aAJH,QAKO,SALP;AAMA,OAAOC,YAAP,MAAyB,0BAAzB;AACA,OAAOC,UAAP,MAAuB,YAAvB;AAGA,OAAOC,KAAP,MAAkB,OAAlB,C,CAEA;;AACA,OAAO,IAAMC,YAAY,GAAG,SAAfA,YAAe,CAACC,QAAD,EAAWC,WAAX,EAAwBC,OAAxB;AAAA,SAAoC,UAAAC,QAAQ,EAAI;AAEzEL,IAAAA,KAAK,CAACM,IAAN,CAAW,oBAAX,EAAiCJ,QAAjC,EACIK,IADJ,CACS,UAAAC,GAAG,EAAI;AAEP;AACAR,MAAAA,KAAK,CAACM,IAAN,CAAW,GAAX,EAAgBH,WAAhB,EAA6BI,IAA7B,CAAkC,UAAAE,IAAI,EAAI;AACvCL,QAAAA,OAAO,CAACM,IAAR,CAAa,QAAb;AACAL,QAAAA,QAAQ,CAAC;AACNM,UAAAA,IAAI,EAAEf,kBADA;AAENgB,UAAAA,OAAO,EAAEJ,GAAG,CAACK,IAAJ,CAASC;AAFZ,SAAD,CAAR;AAIF,OAND,EAOIC,KAPJ,CAOU,UAAAC,IAAI;AAAA,eAAIX,QAAQ,CAAC;AAClBM,UAAAA,IAAI,EAAEjB,UADY;AAElBkB,UAAAA,OAAO,EAAEI,IAAI,CAACC,QAAL,CAAcJ;AAFL,SAAD,CAAZ;AAAA,OAPd,EAHO,CAcF;AACP,KAhBP,EAkBIE,KAlBJ,CAkBU,UAAAG,GAAG;AAAA,aAAIb,QAAQ,CAAC;AACpBM,QAAAA,IAAI,EAAEjB,UADc;AAEpBkB,QAAAA,OAAO,EAAEM,GAAG,CAACD,QAAJ,CAAaJ;AAFF,OAAD,CAAZ;AAAA,KAlBb;AAuBF,GAzB2B;AAAA,CAArB,C,CA4BP;;AACA,OAAO,IAAMM,YAAY,GAAG,SAAfA,YAAe;AAAA,SAAM,UAAAd,QAAQ,EAAK;AAC5CA,IAAAA,QAAQ,CAAC;AACNM,MAAAA,IAAI,EAAEd,aADA;AAENe,MAAAA,OAAO,EAAE;AAFH,KAAD,CAAR;AAIF,GAL2B;AAAA,CAArB,C,CAQP;;AACA,OAAO,IAAMQ,SAAS,GAAG,SAAZA,SAAY,CAAClB,QAAD;AAAA,SAAc,UAAAG,QAAQ,EAAI;AAChDL,IAAAA,KAAK,CAACM,IAAN,CAAW,iBAAX,EAA8BJ,QAA9B,EACIK,IADJ,CACS,UAAAC,GAAG,EAAI;AAAA,UACFa,KADE,GACQb,GAAG,CAACK,IADZ,CACFQ,KADE,EAEV;;AACAC,MAAAA,YAAY,CAACC,OAAb,CAAqB,UAArB,EAAiCF,KAAjC,EAHU,CAIV;;AACAvB,MAAAA,YAAY,CAACuB,KAAD,CAAZ,CALU,CAMV;;AACA,UAAMG,OAAO,GAAGzB,UAAU,CAACsB,KAAD,CAA1B;AAEAhB,MAAAA,QAAQ,CAACoB,cAAc,CAACD,OAAD,CAAf,CAAR;AAEF,KAZJ,EAaIT,KAbJ,CAaU,UAAAG,GAAG;AAAA,aAAKb,QAAQ,CAAC;AACrBM,QAAAA,IAAI,EAAEjB,UADe;AAErBkB,QAAAA,OAAO,EAAEM,GAAG,CAACD,QAAJ,CAAaJ;AAFD,OAAD,CAAb;AAAA,KAbb;AAiBF,GAlBwB;AAAA,CAAlB,C,CAqBP;;AACA,OAAO,IAAMY,cAAc,GAAG,SAAjBA,cAAiB,CAACD,OAAD,EAAa;AACxC,SAAO;AACJb,IAAAA,IAAI,EAAEhB,gBADF;AAEJiB,IAAAA,OAAO,EAAEY;AAFL,GAAP;AAIF,CALM,C,CAQP;;AACA,OAAO,IAAME,UAAU,GAAG,SAAbA,UAAa;AAAA,SAAM,UAAArB,QAAQ,EAAI;AACzC;AACAiB,IAAAA,YAAY,CAACK,UAAb,CAAwB,UAAxB,EAFyC,CAGzC;;AACA7B,IAAAA,YAAY,CAAC,KAAD,CAAZ,CAJyC,CAKzC;;AACAO,IAAAA,QAAQ,CAACoB,cAAc,CAAC,EAAD,CAAf,CAAR,CANyC,CAMX;AAC9B;AACF,GARyB;AAAA,CAAnB","sourcesContent":["import {\r\n   GET_ERRORS,\r\n   SET_CURRENT_USER,\r\n   ALERT_REGISTRATION,\r\n   HIDE_REGMODAL\r\n} from './types';\r\nimport setAuthToken from '../../utils/setAuthToken';\r\nimport jwt_decode from 'jwt-decode';\r\n\r\n\r\nimport axios from 'axios';\r\n\r\n//Register\r\nexport const registerUser = (userData, profileData, history) => dispatch => {\r\n\r\n   axios.post('api/users/register', userData)\r\n      .then(res => {\r\n\r\n            //make dummy userProfile db in registration\r\n            axios.post('/', profileData).then(res2 => {\r\n               history.push('/login');\r\n               dispatch({\r\n                  type: ALERT_REGISTRATION,\r\n                  payload: res.data.name\r\n               });\r\n            })\r\n               .catch(err2 => dispatch({\r\n                     type: GET_ERRORS,\r\n                     payload: err2.response.data\r\n                  })\r\n               );//----------------------------\r\n         }\r\n      )\r\n      .catch(err => dispatch({\r\n         type: GET_ERRORS,\r\n         payload: err.response.data})\r\n      );\r\n\r\n};\r\n\r\n\r\n//Hide registration modal\r\nexport const hideRegModal = () => dispatch =>  {\r\n   dispatch({\r\n      type: HIDE_REGMODAL,\r\n      payload: null\r\n   });\r\n};\r\n\r\n\r\n//Login\r\nexport const loginUser = (userData) => dispatch => {\r\n   axios.post('api/users/login', userData)\r\n      .then(res => {\r\n         const { token } = res.data;\r\n         //Save token to local storage\r\n         localStorage.setItem('jwtToken', token);\r\n         //Set Auth header\r\n         setAuthToken(token);\r\n         //Decode token to get current user data\r\n         const decoded = jwt_decode(token);\r\n\r\n         dispatch(setCurrentUser(decoded));\r\n\r\n      })\r\n      .catch(err => (dispatch({\r\n         type: GET_ERRORS,\r\n         payload: err.response.data}))\r\n      );\r\n};\r\n\r\n\r\n//set current user function\r\nexport const setCurrentUser = (decoded) => {\r\n   return {\r\n      type: SET_CURRENT_USER,\r\n      payload: decoded\r\n   };\r\n};\r\n\r\n\r\n//Log User Out\r\nexport const logUserOut = () => dispatch => {\r\n   //Delete token\r\n   localStorage.removeItem('jwtToken');\r\n   //Remove auth header\r\n   setAuthToken(false);\r\n   //Set current user to {}\r\n   dispatch(setCurrentUser({})); //dispatch to update the store\r\n   //\r\n};\r\n\r\n"]},"metadata":{},"sourceType":"module"}